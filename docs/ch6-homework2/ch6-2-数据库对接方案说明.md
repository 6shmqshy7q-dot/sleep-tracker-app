# CH6-2 æ•°æ®åº“å¯¹æ¥æ–¹æ¡ˆè¯´æ˜

## é¡¹ç›®æ¦‚è¿°

**é¡¹ç›®åç§°**: Next.js + Neon + Drizzle ORM ç”¨æˆ·è®¤è¯ç³»ç»Ÿ
**åˆ†æ”¯åç§°**: student-å°è±ª
**å®Œæˆæ—¥æœŸ**: 2026-01-04

---

## 1. é¡¹ç›®æºç ç»“æ„

```
ğŸ“ project-template-student/
â”œâ”€â”€ ğŸ“ app/                      # Next.js App Router
â”‚   â”œâ”€â”€ page.tsx                 # é¦–é¡µ
â”‚   â”œâ”€â”€ ğŸ“ api/                  # API æ¥å£
â”‚   â”‚   â”œâ”€â”€ test-db/route.js     # æ•°æ®åº“è¿æ¥æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ test-drizzle/route.js # ç”¨æˆ· CRUD æ¥å£
â”‚   â”‚   â”œâ”€â”€ create-tables/route.js # è¡¨åˆ›å»ºæ¥å£
â”‚   â”‚   â””â”€â”€ ğŸ“ auth/
â”‚   â”‚       â”œâ”€â”€ [...nextauth]/route.ts # NextAuth è®¤è¯
â”‚   â”‚       â””â”€â”€ register/route.ts      # ç”¨æˆ·æ³¨å†Œæ¥å£
â”‚   â””â”€â”€ ğŸ“ auth/                 # è®¤è¯é¡µé¢
â”‚       â”œâ”€â”€ signin/page.tsx      # ç™»å½•é¡µ
â”‚       â””â”€â”€ signup/page.tsx      # æ³¨å†Œé¡µ
â”œâ”€â”€ ğŸ“ src/
â”‚   â”œâ”€â”€ ğŸ“ db/                   # æ•°æ®åº“å±‚
â”‚   â”‚   â”œâ”€â”€ index.ts             # Drizzle å®¢æˆ·ç«¯é…ç½®
â”‚   â”‚   â””â”€â”€ schema.ts            # æ•°æ®è¡¨ Schema å®šä¹‰
â”‚   â””â”€â”€ ğŸ“ lib/
â”‚       â””â”€â”€ auth.ts              # NextAuth é…ç½®
â”œâ”€â”€ drizzle.config.js            # Drizzle ORM é…ç½®
â”œâ”€â”€ package.json                 # é¡¹ç›®ä¾èµ–
â””â”€â”€ .env.local                   # ç¯å¢ƒå˜é‡ï¼ˆä¸æäº¤ï¼‰
```

---

## 2. å®ç°çš„åŠŸèƒ½

### 2.1 æ•°æ®åº“åŠŸèƒ½
- [x] Neon PostgreSQL äº‘æ•°æ®åº“è¿æ¥
- [x] Drizzle ORM ç±»å‹å®‰å…¨æŸ¥è¯¢
- [x] Users è¡¨è®¾è®¡ï¼ˆid, username, email, password, timestampsï¼‰
- [x] ç”¨æˆ·æ•°æ® CRUD æ“ä½œ

### 2.2 è®¤è¯åŠŸèƒ½
- [x] ç”¨æˆ·æ³¨å†Œï¼ˆå¯†ç  bcrypt åŠ å¯†ï¼‰
- [x] ç”¨æˆ·ç™»å½•ï¼ˆNextAuth.js Credentials Providerï¼‰
- [x] Session ç®¡ç†
- [x] å®‰å…¨çš„å¯†ç å­˜å‚¨

### 2.3 API æ¥å£
| æ¥å£ | æ–¹æ³• | åŠŸèƒ½ |
|------|------|------|
| `/api/test-db` | GET | æµ‹è¯•æ•°æ®åº“è¿æ¥ |
| `/api/test-drizzle` | GET | æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ· |
| `/api/test-drizzle` | POST | åˆ›å»ºæ–°ç”¨æˆ· |
| `/api/test-drizzle` | DELETE | åˆ é™¤æµ‹è¯•æ•°æ® |
| `/api/auth/register` | POST | ç”¨æˆ·æ³¨å†Œ |
| `/api/auth/[...nextauth]` | * | NextAuth è®¤è¯ |

---

## 3. ä½¿ç”¨çš„æŠ€æœ¯æ ˆ

### 3.1 å‰ç«¯æ¡†æ¶
- **Next.js 15** - React å…¨æ ˆæ¡†æ¶ï¼ŒApp Router æ¶æ„
- **React 19** - UI ç»„ä»¶åº“
- **TypeScript** - ç±»å‹å®‰å…¨

### 3.2 æ•°æ®åº“
- **Neon** - Serverless PostgreSQL äº‘æ•°æ®åº“
- **Drizzle ORM** - ç±»å‹å®‰å…¨çš„ TypeScript ORM
- **@neondatabase/serverless** - Neon HTTP é©±åŠ¨

### 3.3 è®¤è¯
- **NextAuth.js v5** - è®¤è¯è§£å†³æ–¹æ¡ˆ
- **bcrypt** - å¯†ç åŠ å¯†

### 3.4 å¼€å‘å·¥å…·
- **drizzle-kit** - æ•°æ®åº“è¿ç§»å·¥å…·
- **dotenv** - ç¯å¢ƒå˜é‡ç®¡ç†

---

## 4. ä½¿ç”¨çš„ AI æ¨¡å‹

### 4.1 AI Coding å·¥å…·
- **Claude Code (CLI)** - Anthropic å®˜æ–¹å‘½ä»¤è¡Œå·¥å…·
- **æ¨¡å‹ç‰ˆæœ¬**: Claude Sonnet 4.5 / minimax-m2

### 4.2 AI è¾…åŠ©å†…å®¹
1. **æ•°æ®åº“è®¾è®¡** - Schema å®šä¹‰ã€å­—æ®µç±»å‹é€‰æ‹©
2. **ä»£ç ç”Ÿæˆ** - API è·¯ç”±ã€è®¤è¯é€»è¾‘
3. **é—®é¢˜æ’æŸ¥** - SSL è¯ä¹¦ã€bcrypt å…¼å®¹æ€§é—®é¢˜
4. **æ–‡æ¡£ç¼–å†™** - é¡¹ç›®ç»“æ„è¯´æ˜ã€README

### 4.3 äººæœºåä½œæ¨¡å¼
```
ç”¨æˆ·éœ€æ±‚ â†’ Claude Code åˆ†æ â†’ ä»£ç å®ç° â†’ ç”¨æˆ·éªŒè¯ â†’ è¿­ä»£ä¼˜åŒ–
```

---

## 5. æ•°æ®åº“å½“å‰çŠ¶æ€

### 5.1 ç”¨æˆ·è¡¨æ•°æ®ï¼ˆå·²æ¸…ç†æµ‹è¯•æ•°æ®ï¼‰
| ID | ç”¨æˆ·å | é‚®ç®± | å¯†ç çŠ¶æ€ |
|----|--------|------|----------|
| 3 | newuser | newuser@example.com | å·²åŠ å¯† |
| 4 | testuser_final | final@test.com | å·²åŠ å¯† |
| 5 | å°è±ª | 491867316@qq.com | å·²åŠ å¯† |

### 5.2 å®‰å…¨æªæ–½
- æ‰€æœ‰å¯†ç ä½¿ç”¨ bcrypt åŠ å¯†å­˜å‚¨
- æ˜æ–‡æµ‹è¯•æ•°æ®å·²æ¸…ç†
- DATABASE_URL é€šè¿‡ç¯å¢ƒå˜é‡ç®¡ç†ï¼Œä¸æäº¤åˆ° Git

---

## 6. è¿è¡Œè¯´æ˜

```bash
# 1. å®‰è£…ä¾èµ–
npm install

# 2. é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env.local
# ç¼–è¾‘ .env.local å¡«å…¥ DATABASE_URL

# 3. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# 4. æµ‹è¯• API
curl http://localhost:3001/api/test-drizzle | jq
```

---

## 7. æäº¤æ¸…å•

- [x] é¡¹ç›®æºç ï¼ˆå«æ•°æ®åº“å¯¹æ¥åŠŸèƒ½ï¼‰
- [x] å¯¹æ¥æ–¹æ¡ˆè¯´æ˜æ–‡æ¡£
- [x] AI å·¥å…·ä½¿ç”¨è¯´æ˜
- [x] æœ¬åœ°å’Œè¿œç¨‹åˆ†æ”¯åŒæ­¥
